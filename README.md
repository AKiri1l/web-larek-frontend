# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура
Выбрана архитектура MVP

M - Model - управление данными 

V - View - отображение данных и обработка дейтсвий пользователя 

P - Presenter - связывание Model и View

## Интерфейсы

### Интерфес товара 
```
interface IProduct {
  id: string;
  description: string;
  image: string;
  title: string;
  category: string;
  price: number;
}
```

### Интерфейс данных в корзине 
```
interface IBasketData {
    items: HTMLElement[];
    total: number;
}
```

### Интерфейс данных на главной странице
```
interface IProductData {
    items: IProduct[];
    total: number;
}
```

### Интерфейс данных для оформления заказа
```
interface IOrderInfo {
    address: string;
    email: string;
    phone: string;
    payment: string;
    orderItems: IProduct[];
}
```

## Базовые классы

### Класс EventEmitter 
Реализует брокер событий, позволяя компонентам приложения обмениваться данными без прямой связи друг с другом. Этот подход улучшает модульность и изоляцию компонентов.
Основные методы:

- on позволяет подписаться на событие. Если событие с указанным именем ещё не зарегистрировано, оно создаётся.
- off удаляет указанного подписчика с события. Если у события больше нет подписчиков, оно удаляется.
- emit генерирует событие с указанными данными. Все подписчики события (или соответствующие шаблону) будут уведомлены.

### Класс Component.
Класс Component предназначен для работы с DOM в веб-приложениях. Класс содержит базовый функционал для управления HTML-элементами, включая управление стилями, текстом, состояниями блокировки и отображения, а также рендеринг данных. Конструктор: принимает на вход container типа HTMLElement.

- toggleClass добавляет, удаляет или переключает CSS-класс для указанного элемента.
- setText устанавливает текстовое содержимое элемента.
- setDisabled управляет состоянием блокировки элемента (disabled).
- setHidden cкрывает элемент, устанавливая его стиль display: none.
- setVisible делает элемент видимым, удаляя стиль display: none.
- setImage устанавливает источник изображения и альтернативный текст для элемента <img>.
- render основной метод рендеринга. Передаёт данные в экземпляр компонента и возвращает корневой элемент container.

## Слой данных

### Класс ProductModel
Класс для работы с данными приложения. Отвечает за логику работы с данными типа IProduct.
Класс:
- protected items: IProduct[]; 
- protected events: IEvents 

- setProducts(items: IProduct[]): void 
- getProducts(): items: IProduct[] 
- getProduct(id: string): IProduct 

### Класс Order 
Класс для работы с заказом. Работает с типами данных IOrderInfo. Он отвечает за хранение информации о заказе, таких как платежные данные, адрес доставки, контактные данные клиента и список товаров, входящих в заказ. Класс также реализует функционал для добавления и удаления продуктов, получения списка товаров и расчета общей стоимости заказа. Этот класс не является наследником других классов.

Конструктор класса принимает следующие параметры:

- payment: string: Строка, представляющая способ оплаты заказа.
- address: string: Строка, указывающая адрес доставки.
- email: string: Строка, содержащая электронную почту клиента.
- phone: string: Строка с номером телефона клиента.
- items: IProduct[]: Массив, состоящий из объектов, реализующих интерфейс IProduct, который представляет товары в заказе.
- events: IEvents: Объект, реализующий интерфейс IEvents, который может использоваться для обработки событий, связанных с заказом.

Класс: 
- protected payment: string: Хранит способ оплаты заказа. Используется для идентификации, как клиент собирается оплатить заказ.
  
- protected address: string: Хранит адрес доставки для заказа. Это значение используется для доставки товаров клиенту.
  
- protected email: string: Хранит электронную почту клиента. Это может быть использовано для рассылки уведомлений о статусе заказа.

- protected phone: string: Хранит номер телефона клиента. Это поле может потребоваться для связи с клиентом, если возникнут какие-либо вопросы по заказу.

- protected items: IProduct[]: Хранит массив товаров, представляющих заказываемые продукты. Это поле отвечает за управление списком продуктов, входящих в заказ.

- protected events: IEvents: Хранит объект для обработки событий, связанных с заказом. Это позволяет взаимодействовать с другими компонентами системы, реагируя на изменения в заказе.

- addProduct(product: IProduct): void: Метод для добавления продукта в заказ. 
    - Параметры: 
      - product: IProduct: Объект, представляющий продукт, который нужно добавить в заказ.
    - Возвращаемое значение: Метод ничего не возвращает.

- deleteProduct(id: string): void: Метод для удаления продукта из заказа по его идентификатору.
    - Параметры: 
      - id: string: Идентификатор продукта, который нужно удалить из заказа.
    - Возвращаемое значение: Метод ничего не возвращает.

- getItems(): IProduct[]: Метод для получения списка товаров в заказе.
    - Возвращаемое значение: Возвращает массив объектов, представляющих товары (IProduct[]), входящие в заказ.

- getTotalPrice(): number: Метод для расчета общей стоимости продуктов в заказе.
    - Возвращаемое значение: Возвращает значение общего количества по всем продуктам в заказе в виде числа (number).

- getTotal(): number: Метод для получения итога заказа, количество позиций в заказе.
    - Возвращаемое значение: Возвращает общее значение заказа в виде числа (number).

### Класс AppApi 
Класс для работы с сервером. Расширяет класс Api.
Класс:
- getProducts(): Promise<IProduct[]> 
- orderProducts(order: IOrderInfo) - отправка заказа на сервер

## Слой отображения
Класс для отображения интерактивных элементов.

### Класс Component:
Базовый класс, который является для всех классов отображения. Содержит метод render для перерисовывания элементов.

### Класс Modal
Класс для работы с модальными окнами. Использует методы open и close.

- protected _content: HTMLElement - контент модального окна
- set content(value: HTMLElement):void - сеттер для контента темплейта
- render(data: HTMLElement): HTMLElement - рендер окна модели

### Класс Page 
Класс отвечающий за отображение элементов на главной странице.
- counter: HTMLElement
- catalog: HTMLElement
- basket: HTMLElement

### Класс Form 
Управляет работой форм в приложении, контролирует состояние кнопки отправки и генерирует события при отправке данных. Конструктор принимает container с типом HTMLElement, в также объект events с типом IEvents.

Поля:
- submit: HTMLButtonElement разметка кнопки сабмита.
- errors: HTMLElement разметка вывода ошибок.

Методы:
- set valid(value: boolean) сеттер включает или отключает кнопку отправки в зависимости от валидности формы.
- set errors(value: string) сеттер устанавливает текст ошибки
- render() обновляет состояние формы, включая валидность, ошибки и значения полей.

### Класс Contacts
Управляет формой контактной информации, расширяя функциональность класса Form для работы с полями телефона и email. Конструктор принимает container с типом HTMLFormElement, представляющий корневой элемент формы, и events с типом IEvents для работы с событиями.
Методы:
- set phone(value: string) устанавливает значение поля телефона.
- set email(value: string) устанавливает значение поля почты.

## Презентер
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в index.ts
В index.ts сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.
